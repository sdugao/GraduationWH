<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>更新文章</title>
<link rel="icon" href="icon.jpg" type="image/ico">
<meta name="keywords" content="个人博客">
<meta name="description" content="个人博客">
<meta name="author" content="gao">
<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/materialdesignicons.min.css" rel="stylesheet">
<link href="css/style.min.css" rel="stylesheet">
<link rel="stylesheet" href="editor.md/examples/css/style.css" />
<link rel="stylesheet" href="editor.md/css/editormd.css" />
<link rel="stylesheet" href="css/mycss_admin.css"/>
<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<script type="text/javascript" src="js/perfect-scrollbar.min.js"></script>
<script type="text/javascript" src="js/main.min.js"></script>
<script src="editor.md/editormd.min.js" type="application/javascript"></script>
<script type="text/javascript" src="js/vue.js"></script>
<script src="js/bootstrap-notify.min.js"></script>
<script type="text/javascript" src="js/lightyear.js"></script>>
</head>

<body>
<div class="lyear-layout-web">
  <div class="lyear-layout-container">
    <!--左侧导航-->
    <aside class="lyear-layout-sidebar">

      <!-- logo -->
      <div id="logo" class="sidebar-header">
        <a href="index.html"><img src="icon.jpg" title="GAO" alt="GAO" /></a>
      </div>
      <div class="lyear-layout-sidebar-scroll">

        <nav class="sidebar-main">
          <ul class="nav nav-drawer">
            <li class="nav-item active"> <a href="index.html"><i class="mdi mdi-home"></i> 后台首页</a> </li>

            <li class="nav-item nav-item-has-subnav">
              <a href="javascript:void(0)"><i class="mdi mdi-pencil"></i> 文章</a>
              <ul class="nav nav-subnav">
                <li> <a href="article_list.html">文章列表</a> </li>
                <li> <a href="lyear_forms_radio.html">写文章</a> </li>
              </ul>
            </li>
            <li class="nav-item nav-item-has-subnav">
              <a href="javascript:void(0)"><i class="mdi mdi-cup"></i>回收站</a>
              <ul class="nav nav-subnav">
                <li> <a href="article_list.html">回收站列表</a> </li>

              </ul>
            </li>
            <li class="nav-item nav-item-has-subnav">
              <a href="javascript:void(0)"><i class="mdi mdi-content-save"></i>评论</a>
              <ul class="nav nav-subnav">
                <li> <a href="comment_list_all.html">全部评论</a> </li>
                <li> <a href="comment_list_not_read.html">未读评论</a> </li>
              </ul>
            </li>
            <li class="nav-item nav-item-has-subnav">
              <a href="javascript:void(0)"><i class="mdi mdi-menu"></i> 其他设置</a>
              <ul class="nav nav-subnav">

                <li class="nav-item nav-item-has-subnav">
                  <a href="edit_pwd.html">修改密码</a>
                </li>


              </ul>
            </li>
          </ul>
        </nav>

        <div class="sidebar-footer">
          <p class="copyright">Copyright &copy; GAO.  All rights reserved.</p>
        </div>
      </div>

    </aside>
    <!--End 左侧导航-->

    <!--头部信息-->
    <header class="lyear-layout-header">

      <nav class="navbar navbar-default">
        <div class="topbar">

          <div class="topbar-left">
            <div class="lyear-aside-toggler">
              <span class="lyear-toggler-bar"></span>
              <span class="lyear-toggler-bar"></span>
              <span class="lyear-toggler-bar"></span>
            </div>
            <span class="navbar-page-title"> 文章-更新文章 </span>
          </div>

          <ul class="topbar-right">
            <li class="dropdown dropdown-profile">
              <a href="javascript:void(0)" data-toggle="dropdown">
                <img class="img-avatar img-avatar-48 m-r-10" src="icon.jpg" alt="GAO" />
                <span>GAO <span class="caret"></span></span>
              </a>
              <ul class="dropdown-menu dropdown-menu-right">
                <li> <a href="lyear_pages_profile.html"><i class="mdi mdi-account"></i> 个人信息</a> </li>
                <li> <a href="lyear_pages_edit_pwd.html"><i class="mdi mdi-lock-outline"></i> 修改密码</a> </li>
                <li> <a href="javascript:void(0)"><i class="mdi mdi-delete"></i> 清空缓存</a></li>
                <li class="divider"></li>
                <li> <a href="admin_login.html"><i class="mdi mdi-logout-variant"></i> 退出登录</a> </li>
              </ul>
            </li>
            <!--切换主题配色-->
		    <li class="dropdown dropdown-skin">
			  <span data-toggle="dropdown" class="icon-palette"><i class="mdi mdi-palette"></i></span>
			  <ul class="dropdown-menu dropdown-menu-right" data-stopPropagation="true">
                <li class="drop-title"><p>主题</p></li>
                <li class="drop-skin-li clearfix">
                  <span class="inverse">
                    <input type="radio" name="site_theme" value="default" id="site_theme_1" checked>
                    <label for="site_theme_1"></label>
                  </span>
                  <span>
                    <input type="radio" name="site_theme" value="dark" id="site_theme_2">
                    <label for="site_theme_2"></label>
                  </span>
                  <span>
                    <input type="radio" name="site_theme" value="translucent" id="site_theme_3">
                    <label for="site_theme_3"></label>
                  </span>
                </li>
			    <li class="drop-title"><p>LOGO</p></li>
				<li class="drop-skin-li clearfix">
                  <span class="inverse">
                    <input type="radio" name="logo_bg" value="default" id="logo_bg_1" checked>
                    <label for="logo_bg_1"></label>
                  </span>
                  <span>
                    <input type="radio" name="logo_bg" value="color_2" id="logo_bg_2">
                    <label for="logo_bg_2"></label>
                  </span>
                  <span>
                    <input type="radio" name="logo_bg" value="color_3" id="logo_bg_3">
                    <label for="logo_bg_3"></label>
                  </span>
                  <span>
                    <input type="radio" name="logo_bg" value="color_4" id="logo_bg_4">
                    <label for="logo_bg_4"></label>
                  </span>
                  <span>
                    <input type="radio" name="logo_bg" value="color_5" id="logo_bg_5">
                    <label for="logo_bg_5"></label>
                  </span>
                  <span>
                    <input type="radio" name="logo_bg" value="color_6" id="logo_bg_6">
                    <label for="logo_bg_6"></label>
                  </span>
                  <span>
                    <input type="radio" name="logo_bg" value="color_7" id="logo_bg_7">
                    <label for="logo_bg_7"></label>
                  </span>
                  <span>
                    <input type="radio" name="logo_bg" value="color_8" id="logo_bg_8">
                    <label for="logo_bg_8"></label>
                  </span>
				</li>
				<li class="drop-title"><p>头部</p></li>
				<li class="drop-skin-li clearfix">
                  <span class="inverse">
                    <input type="radio" name="header_bg" value="default" id="header_bg_1" checked>
                    <label for="header_bg_1"></label>
                  </span>
                  <span>
                    <input type="radio" name="header_bg" value="color_2" id="header_bg_2">
                    <label for="header_bg_2"></label>
                  </span>
                  <span>
                    <input type="radio" name="header_bg" value="color_3" id="header_bg_3">
                    <label for="header_bg_3"></label>
                  </span>
                  <span>
                    <input type="radio" name="header_bg" value="color_4" id="header_bg_4">
                    <label for="header_bg_4"></label>
                  </span>
                  <span>
                    <input type="radio" name="header_bg" value="color_5" id="header_bg_5">
                    <label for="header_bg_5"></label>
                  </span>
                  <span>
                    <input type="radio" name="header_bg" value="color_6" id="header_bg_6">
                    <label for="header_bg_6"></label>
                  </span>
                  <span>
                    <input type="radio" name="header_bg" value="color_7" id="header_bg_7">
                    <label for="header_bg_7"></label>
                  </span>
                  <span>
                    <input type="radio" name="header_bg" value="color_8" id="header_bg_8">
                    <label for="header_bg_8"></label>
                  </span>
				</li>
				<li class="drop-title"><p>侧边栏</p></li>
				<li class="drop-skin-li clearfix">
                  <span class="inverse">
                    <input type="radio" name="sidebar_bg" value="default" id="sidebar_bg_1" checked>
                    <label for="sidebar_bg_1"></label>
                  </span>
                  <span>
                    <input type="radio" name="sidebar_bg" value="color_2" id="sidebar_bg_2">
                    <label for="sidebar_bg_2"></label>
                  </span>
                  <span>
                    <input type="radio" name="sidebar_bg" value="color_3" id="sidebar_bg_3">
                    <label for="sidebar_bg_3"></label>
                  </span>
                  <span>
                    <input type="radio" name="sidebar_bg" value="color_4" id="sidebar_bg_4">
                    <label for="sidebar_bg_4"></label>
                  </span>
                  <span>
                    <input type="radio" name="sidebar_bg" value="color_5" id="sidebar_bg_5">
                    <label for="sidebar_bg_5"></label>
                  </span>
                  <span>
                    <input type="radio" name="sidebar_bg" value="color_6" id="sidebar_bg_6">
                    <label for="sidebar_bg_6"></label>
                  </span>
                  <span>
                    <input type="radio" name="sidebar_bg" value="color_7" id="sidebar_bg_7">
                    <label for="sidebar_bg_7"></label>
                  </span>
                  <span>
                    <input type="radio" name="sidebar_bg" value="color_8" id="sidebar_bg_8">
                    <label for="sidebar_bg_8"></label>
                  </span>
				</li>
			  </ul>
			</li>
            <!--切换主题配色-->
          </ul>

        </div>
      </nav>

    </header>
    <!--End 头部信息-->

    <!--texarea-->
    <main class="lyear-layout-content">
    <div class="panel panel-default my-frame">
      <div class="panel-body" >
          <div class="container-fluid">
              <div class="row">
                  <div class="col-lg-12 col-lg-12 col-sm-12 col-sm-12"  id = vue_submit>
                      <h2><span class="glyphicon glyphicon-pencil my-title" aria-hidden="true"></span> 修改文章</h2>
                      <hr style="color: black">


<!--
                      <div v-if="submit_success">
                          <div class="col-lg-12 col-lg-12 col-sm-12 col-sm-12">
                              <div  class="alert alert-success" role="alert">添加成功</div>
                          </div>
                      </div>


                      <div v-if="submit_failure">
                        <div class="col-lg-12 col-lg-12 col-sm-12 col-sm-12">
                            <div  class="alert alert-warning" role="alert">添加失败</div>
                        </div>
                    </div> -->

                      <form action="#" method="post">
                          <div class="form-group">
                              <input  class="form-control" id="question-tittle" name="question-tittle" placeholder="请输入问题标题" v-model="msg.tittle">
                          </div>
                          <div class="form-group" id="test-editormd">
                              <textarea style="display:none;"  id="question-details" name="question-details" rows="10"  v-model="msg.content"></textarea>
                          </div>


                          <div class="form-group">
                              <input  class="form-control" id="question-tag" name="question-tag" placeholder="请输入标签，以逗号隔开" v-model="msg.tag">
                          </div>

                          <button type="button" class="my-btn-write-submit" @click="submit()">提交</button>
                      </form>


                  </div>
              </div>
          </div>
        </div>
    </div>
    </main>
    <!--end_textarea-->
  </div>
</div>


<script type="text/javascript">
  var testEditor;

  $(function() {
      testEditor = editormd("test-editormd", {
          width   : "100%",
          height  : 680,
          syncScrolling : "single",
          path    : "editor.md/lib/"
      });

      /*
      // or
      testEditor = editormd({
          id      : "test-editormd",
          width   : "90%",
          height  : 640,
          path    : "../lib/"
      });
      */
  });
</script>



     <!-- 提交 -->
     <script type="text/javascript">
      var vm = new Vue({
        el: '#vue_submit',
        data:{
          code:0,
          msg:{}
        },
        methods: {
            getQueryVariable:function (variable){
                        var query = window.location.search.substring(1);
                        var vars = query.split("&");
                        for (var i=0;i<vars.length;i++) {
                        var pair = vars[i].split("=");
                            if(pair[0] == variable){return pair[1];}
                        }
                    return(false);
                    },

                    getContent:function(){
                        $.ajax({
                            type: 'post',
                            sync: true,
                            //contentType: "application/x-www-form-urlencoded; charset=utf-8",//x-www-form-urlencoded
                            url:  'http://localhost:8848/admin/articles/details/'+this.getQueryVariable("id"),
                            data:{
                            },
                            dataType: 'json',
                            success: function (result) {
                                //console.log(result);
                                vm.code = result.code;
                                //console.log(vm.code);
                                vm.msg = result.message;
                                //console.log(vm.content);

                            }
                        });
                    },
            submit:function(){
              vm.msg.content=document.getElementById('question-details').innerHTML;
              if(vm.msg.tittle==""){
                alert("文章标题不能为空");
                return ;
              }
              if(vm.msg.content==""){
                alert("文章内容不能为空");
                return ;
              }
              if(vm.msg.tag==""){
                alert("文章标签不能为空");
                return ;
              }
              $.ajax({
          type: 'post',
          sync: false,
          url:  'http://localhost:8848/admin/articles/update',
          data:JSON.stringify(vm.msg),
          contentType: 'application/json;charset=UTF-8',
          dataType: 'json',
          success: function (result) {
            vm.code=result.code;
            if(vm.code==200){
              //vm.submit_success=true;
              lightyear.notify('修改成功', 'info', 1000, 'mdi mdi-emoticon-happy', 'bottom', 'center');
            }
            else{
              //vm.submit_failure=true;
              lightyear.notify('修改失败，请稍后在试', 'danger', 1000, 'mdi mdi-emoticon-sad', 'bottom', 'center');
            }

      }
  });
            }
        },
      });

    </script>


<!-- 页面加载发送请求填入信息 -->
<script>

    window.onload=vm.getContent();

</script>
</body>
</html>